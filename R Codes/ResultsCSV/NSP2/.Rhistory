shiny::runApp()
install.packages("geomnet")
runApp()
runApp()
mydata<-data.frame(
Protein = c("NSP2",
"NSP5",
"NSP4",
"PDI",
"dsRNA",
"VP6",
"VP4",
"VP760",
"VP7159"),
Radius = c(0.1,
0.7046756*2,
1.0010242*2,
1.0042976*2,
1.1531351*2,
1.1693188*2,
1.3056831*2,
1.3837886*2,
1.5857182*2))
mydata<-mutate(mydata,X=rep(0,9),Y=rep(0,9))
mydata$Protein<-factor(mydata$Protein,levels =
levels(mydata$Protein)[c(4,3,5,2,1,7,6,9,8)])
mydata$Radius<-as.numeric(mydata$Radius)
ggplot()+geom_point()+
geom_circle(aes(x0=X, y0=Y, r=Radius, color=Protein), data=mydata)+
geom_text(data=mydata, mapping=aes(x=0, y=Radius+0.03, label=Protein), size=4)+
scale_x_discrete()+scale_y_discrete()+ylab("")+xlab("")#+theme(legend.position = "none")
ggplot()+geom_point()+
geom_circle(aes(x=X, y=Y, r=Radius, color=Protein), data=mydata)+
geom_text(data=mydata, mapping=aes(x=0, y=Radius+0.03, label=Protein), size=4)+
scale_x_discrete()+scale_y_discrete()+ylab("")+xlab("")#+theme(legend.position = "none")
ggplot()+geom_point()+
geom_circle(aes(x0=X, y0=Y, r=Radius, color=Protein), data=mydata)+
geom_text(data=mydata, mapping=aes(x=0, y=Radius+0.03, label=Protein), size=4)+
scale_x_discrete()+scale_y_discrete()+ylab("")+xlab("")#+theme(legend.position = "none")
# circles are drawn centered at x and y
library(ggplot2)
data(mpg)
ggplot(mpg, aes(displ, hwy)) + geom_circle(radius=0.1) + geom_point()
ggplot()+geom_point()+
geom_circle(aes(x0=X, y0=Y, radius=Radius, color=Protein), data=mydata)+
geom_text(data=mydata, mapping=aes(x=0, y=Radius+0.03, label=Protein), size=4)+
scale_x_discrete()+scale_y_discrete()+ylab("")+xlab("")#+theme(legend.position = "none")
ggplot()+geom_point()+
geom_circle(aes(x=X, y=Y, radius=Radius, color=Protein), data=mydata)+
geom_text(data=mydata, mapping=aes(x=0, y=Radius+0.03, label=Protein), size=4)+
scale_x_discrete()+scale_y_discrete()+ylab("")+xlab("")#+theme(legend.position = "none")
ggplot()+
geom_circle(aes(x=X, y=Y, radius=Radius, color=Protein), data=mydata)+
geom_text(data=mydata, mapping=aes(x=0, y=Radius+0.03, label=Protein), size=4)+
scale_x_discrete()+scale_y_discrete()+ylab("")+xlab("")
ggplot(data=mydata,aes(x = X,y = Y))+geom_point()+
geom_circle(aes(x=X, y=Y, radius=Radius, color=Protein), data=mydata)+
geom_text(data=mydata, mapping=aes(x=0, y=Radius+0.03, label=Protein), size=4)+
scale_x_discrete()+scale_y_discrete()+ylab("")+xlab("")
mydata
install.packages("ggforce")
install.packages("ggforce")
runApp()
circles <- data.frame(
x0 = rep(1:3, 3),
y0 =  rep(1:3, each=3),
r = seq(0.1, 1, length.out = 9)
)
# Behold the some circles
ggplot() + geom_circle(aes(x0=x0, y0=y0, r=r, fill=r), data=circles)
library("ggforce")
circles <- data.frame(
x0 = rep(1:3, 3),
y0 =  rep(1:3, each=3),
r = seq(0.1, 1, length.out = 9)
)
# Behold the some circles
ggplot() + geom_circle(aes(x0=x0, y0=y0, r=r, fill=r), data=circles)
runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
install.packages("plotly")
install.packages("ggforce")
library(ggforce)
install.packages("ggforce")
library(ggforce)
install.packages("geomnet")
library(geomnet)
install.packages('devtools')
install.packages("geomnet")
library(geomnet)
runApp()
shiny::runApp()
runApp()
runApp()
shiny::runApp()
# Load Libraries
library(dplyr)
library(ggplot2)
library(cowplot)
library(plotly)
library(ggsignif)
library(RColorBrewer)
library(gplots)
library(gdata)
# Change work directory and Load data
setwd('/home/yasel/Dropbox/Paper Viroplasmas/Programs/R/ResultsCSV/NSP2/')
dsRNA<-read.csv('NSP2rojo-dsRNAverde.csv')
#PDI<-read.csv('NSP2rojo-PDIverde.csv')
VP4<-read.csv('NSP2rojo-VP4verde.csv')
VP6<-read.csv('NSP2rojo-VP6verde.csv')
VP760<-read.csv('NSP2rojo-VP760verde.csv')
VP7159<-read.csv('NSP2rojo-VP7159verde.csv')
NSP4<-read.csv('NSP4rojo-NSP2verde.csv')
NSP5<-read.csv('NSP5rojo-NSP2verde.csv')
VP1<-read.csv('NSP2rojo-VP1verde.csv')
VP2<-read.csv('NSP2rojo-VP2verde.csv')
##-----------------------------------------------
## Data manipulation
# Create a factor variable with the protein name
dsRNA<-mutate(dsRNA, Protein='dsRNA')
#PDI<-mutate(PDI, Protein='PDI')
VP4<-mutate(VP4, Protein='VP4')
VP6<-mutate(VP6, Protein='VP6')
VP760<-mutate(VP760, Protein='VP760')
VP7159<-mutate(VP7159, Protein='VP7159')
NSP4<-mutate(NSP4, Protein='NSP4')
NSP5<-mutate(NSP5, Protein='NSP5')
VP1<-mutate(VP1, Protein='VP1')
VP2<-mutate(VP2, Protein='VP2')
# Selection of the samples
NSP5<-tail(arrange(NSP5,desc(NSP5$ratioNSP2)),35)
# PDI<-tail(arrange(PDI,desc(abs(mean_dsRNA-PDI$ratioNSP2))),32)
NSP4<-tail(arrange(NSP4,desc(NSP4$ratioNSP2)),40)
# VP4<-tail(arrange(VP4,desc(VP4$ratioNSP2)),32)
# VP7159<-tail(arrange(VP7159,desc(ratioNSP2)),32)
VP760<-tail(arrange(VP760,desc(VP760$ratioNSP2)),60)
VP1<-head(arrange(VP1,desc(VP1$ratioNSP2)),40)
VP2<-head(arrange(VP2,desc(VP2$ratioNSP2)),40)
VP6<-head(arrange(VP6,desc(VP6$ratioNSP2)),60)
##-----------------------------------------------
# Merge the data in a same data frame
viroData<-rbind(VP6,NSP4,NSP5,VP4,dsRNA,VP7159,VP760,VP1,VP2)
viroData$Protein<-as.factor(viroData$Protein)
viroData$Distance=viroData$Distance/100
viroData$ratioNSP2=viroData$ratioNSP2/100
viroData$ratioOther=viroData$ratioOther/100
##################################################################################
####################################################
allProteins<-mutate(viroData,Comparation="Other Protein")
forNSP2<-select(allProteins,one_of(c("ratioNSP2","Protein")))
forNSP2<-mutate(forNSP2,Comparation="NSP2")
allProteins<-data.frame(Comparation=c(forNSP2$Comparation,allProteins$Comparation),
Protein=c(as.character(forNSP2$Protein),as.character(allProteins$Protein)),
Value=c(forNSP2$ratioNSP2,allProteins$ratioOther))
allProteins$Protein<-factor(allProteins$Protein,levels = levels(allProteins$Protein)[c(3,2,4,5,7,1,6,8,9)])
p<-ggplot(allProteins, aes(x = Protein, y = Value,fill=Comparation)) +
geom_boxplot(notch=TRUE)+ylab(expression(
paste("Radius of the adjusted circumference"," ", (paste(mu,m)))))+
theme(legend.position = "bottom")+
scale_y_continuous(breaks = seq(from = 0.2, to = 1.5, by =0.1),limits = c(0.2,1.2))
p
# Just NSP2 in all combinations
compareNSP2<-subset(allProteins,Comparation=="NSP2")
p<-ggplot(compareNSP2,aes(x = Protein,y = Value,fill="red"))+geom_boxplot(notch = TRUE)+
geom_signif(test="wilcox.test", comparisons = combn(levels(compareNSP2$Protein),2, simplify = F)[-4],
step_increase = 0.2,map_signif_level=TRUE)+theme(legend.position = "none")+ylab("Value")+xlab("NSP2")+
scale_y_continuous(breaks = seq(0,1,0.15),labels = seq(0,1,0.15))
p
# Just in viroData ----------------------------------------------
p<-ggplot(viroData, aes(x = Protein, y = Distance,fill=Protein)) +
geom_boxplot(notch=TRUE,show.legend=FALSE)+
ylab(expression(paste("Distance to NSP2"," ",(paste(mu,m)))))+
xlab("Protein")+scale_y_continuous(breaks = seq(from = -.5, to = .8, by =0.1))+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
p
p+geom_signif(test="wilcox.test", comparisons = combn(levels(viroData$Protein),2, simplify = F)[-5],
step_increase = 0.05,map_signif_level=TRUE)
levels(viroData$Protein)
viroData$Protein<-factor(viroData$Protein,levels = levels(viroData$Protein)[c(3,2,4,5,7,1,6,7,8)])
levels(viroData$Protein)
viroData$Protein<-factor(viroData$Protein,levels = levels(viroData$Protein)[c(3,2,4,5,7,1,6,8,9)])
# Just in viroData ----------------------------------------------
p<-ggplot(viroData, aes(x = Protein, y = Distance,fill=Protein)) +
geom_boxplot(notch=TRUE,show.legend=FALSE)+
ylab(expression(paste("Distance to NSP2"," ",(paste(mu,m)))))+
xlab("Protein")+scale_y_continuous(breaks = seq(from = -.5, to = .8, by =0.1))+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
p+geom_signif(test="wilcox.test", comparisons = combn(levels(viroData$Protein),2, simplify = F)[-5],
step_increase = 0.05,map_signif_level=TRUE)
pdf(file = "/home/yasel/Dropbox/Belgium/Presentation/Figures/Boxplot_Wilcox_Proteins.pdf",width = 6.8,height = 8)
p+geom_signif(test="wilcox.test", comparisons = combn(levels(viroData$Protein),2, simplify = F)[-5],
step_increase = 0.05,map_signif_level=TRUE)
dev.off()
p+geom_signif(test="wilcox.test", comparisons = combn(levels(viroData$Protein),2, simplify = F)[-5],
step_increase = 0.01,map_signif_level=TRUE)
250/6
